---
title: "Monster movies"
format:
  html:
    theme: darkly
editor_options: 
  chunk_output_type: console
---

# The Monster movies dataset

In this analysis, we will explore the Monster movies dataset from TidyTuesday. The dataset contains information about monster movies, including their titles, years of release, genres, IMDB ratings, and number of votes.

```{r setup}
# | message: false
# | warning: false

library(tidyverse)
library(widyr)
library(ggdark)

theme_set(dark_theme_minimal())
```
# Read the data

```{r data_read}
mm_raw <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2024/2024-10-29/monster_movies.csv')

mm <- 
    mm_raw |> 
    # Create a decade variable
    mutate(decade = floor(year/10) * 10)

# Take a look at the data
mm |> glimpse()

```

# The number of movies by year

Monster movies have been produced for many decades. Let's see how many monster movies were produced each year.

```{r}
# Two different ways to show the number of movies by decade
mm |> 
    ggplot() +
    aes(x = decade) +
    geom_bar()

mm |> 
    count(decade) |> 
    ggplot() +
    aes(x = decade, y = n) +
    geom_line(color = "orange", linewidth = 1.2) +
    labs(title = "Number of monster movies by decade", x = NULL, y = NULL)

```

# Analyze the genres

In this part, we will analyze the genres of monster movies. Each movie can have multiple genres separated by commas.

```{r}
# Separate the genres into multiple rows
mm_genre <-
    mm |> 
    separate_rows(genres, sep = ",")

# Count the number of movies by genre
mm_genre |> 
    count(genres, sort = TRUE)

```

## Co-occurence of genres

In this part, we will analyze the co-occurence of genres in monster movies.

```{r}
# Create a co-occurence matrix of genres
mm_genre |> 
    pairwise_count(item = genres, feature = tconst, sort = TRUE, upper = FALSE) |> 
    ggplot() +
    aes(x = item1, y = item2, fill = n) +
    geom_tile() +
    scale_fill_viridis_c() +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1)) +
    labs(title = "Co-occurence of genres in monster movies",
         x = NULL, y = NULL,
         fill = "Number")

```

## Rating of genres

Some genres may have higher average ratings than others. Let's analyze the average rating of monster movies by genre.

```{r}
# Calculate average rating by genre
genre_ratings <-
    mm_genre |> 
    group_by(genres) |> 
    summarise(avg_rating = mean(average_rating),
              n_rating = n(),
              sd_rating = sd(average_rating),
              se_rating = sd_rating/sqrt(n_rating),
              .groups = "drop"
              ) |> 
    # Filter genres with at least 10 ratings
    filter(n_rating >= 10) |> 
    arrange(-avg_rating)

# Plot average rating by genre
genre_ratings |> 
    mutate(genres = fct_reorder(genres, avg_rating)) |> 
    ggplot() +
    aes(x = avg_rating, y = genres, 
        xmin = avg_rating - se_rating,
        xmax = avg_rating + se_rating) +
    geom_col(fill = "orange") +
    geom_linerange(color = "white") +
    labs(y = NULL, x = "Average IMDB rating (SE)",
         title = "Average rating of monster movies by genre")

```


# Correlate the number of votes and rating

Can we see any correlation between the number of votes and the average rating of monster movies? We are looking for a linear trend and a smoothed trend.

```{r}
#| message: false
#| warning: false

mm |> 
    arrange(-num_votes)

mm |> 
    ggplot() +
    aes(x = num_votes, y = average_rating) +
    geom_point(color = "orange") +
    scale_x_log10(labels = scales::label_log()) +
    geom_smooth() +
    geom_smooth(method = "lm", color = "red") +
    labs(y = "Average IMDB rating",
         title = "Average rating of monster movies by number of votes",
         subtitle = "Two models show different trends",
         x = "Number of votes (log scale)")


```



